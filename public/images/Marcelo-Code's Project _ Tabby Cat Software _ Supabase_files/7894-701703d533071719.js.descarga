!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="953eb273-916e-4058-9216-35d2ec9ce429",e._sentryDebugIdIdentifier="sentry-dbid-953eb273-916e-4058-9216-35d2ec9ce429")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7894],{97894:function(e,t,n){n.d(t,{l5:function(){return eh.Z},mM:function(){return eD}});var l=n(31549),o=n(40540),r=n(86474),a=n.n(r),i=n(50378),s=n(44194),d=n(88042),c=n(14052),u=n(63969),f=n(56321),m=n(59928),x=n(41121),v=n(98334),h=n(52981),g=n(79405),p=n(80420),b=n(92023),y=n(43083);function w(e){let{gridRef:t,rows:n}=e,l=(0,p.uM)(),o=(0,s.useMemo)(()=>{var e,t;return"windows"==((null===(e=navigator)||void 0===e?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null===(t=navigator)||void 0===t?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command"},[]);return(0,y.a)({["".concat(o,"+ArrowUp")]:e=>{if(e.stopPropagation(),l.selectedCellPosition){var n,o;let e={idx:null!==(o=null===(n=l.selectedCellPosition)||void 0===n?void 0:n.idx)&&void 0!==o?o:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(o,"+ArrowDown")]:e=>{if(e.stopPropagation(),l.selectedCellPosition){var o,r;let e={idx:null!==(r=null===(o=l.selectedCellPosition)||void 0===o?void 0:o.idx)&&void 0!==r?r:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(o,"+ArrowLeft")]:e=>{var n,o;e.stopPropagation();let r={idx:l.gridColumns.filter(e=>e.frozen).length,rowIdx:null!==(o=null===(n=l.selectedCellPosition)||void 0===n?void 0:n.rowIdx)&&void 0!==o?o:0};t.current.selectCell(r)},["".concat(o,"+ArrowRight")]:e=>{var n,o,r;e.stopPropagation(),null===(o=t.current)||void 0===o||o.selectCell({idx:l.gridColumns.length-2,rowIdx:null!==(r=null===(n=l.selectedCellPosition)||void 0===n?void 0:n.rowIdx)&&void 0!==r?r:0})}},["INPUT","TEXTAREA","SELECT"]),null}var j=n(21930),N=n(8539),C=n(28243),S=n(72303),E=n(32890),k=n(84407),R=n(38694),_=n(60038),P=n(19106),T=n(96171),I=n(32081),D=n(35322),L=n(95100),F=n(64098),M=n(16692);let z=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t];return"".concat((e/Math.pow(1e3,t>4?4:t)).toFixed(1)).concat(n)},A=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}];var O=()=>{var e,t;let{id:n}=(0,d.UO)(),o=n?Number(n):void 0,{project:r}=(0,m.d2)(),a=(0,g._2)(),i=(0,p.uM)(),{data:c}=(0,C.iB)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,id:o}),u=(0,S.N3)(c)?c.live_rows_estimate:null,[{filter:f}]=(0,E.x)({arrayKeys:["filter"]}),x=(0,b.Yb)(f),v=i.page,y=(0,h.fN)(),[w,j]=(0,s.useState)(!1),[N,k]=(0,s.useState)(!1),[O,G]=(0,s.useState)(!1),[K,Z]=(0,s.useState)(v.toString());(0,s.useEffect)(()=>{Z(String(v))},[v]);let{data:U,isLoading:Q,isSuccess:V,isError:W,isFetching:q}=(0,T.HS)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,tableId:o,filters:x,enforceExactCount:i.enforceExactCount,roleImpersonationState:y},{keepPreviousData:!0}),B=(null==U?void 0:U.is_estimate)?z(U.count):null==U?void 0:U.count.toLocaleString(),X=Math.ceil((null!==(e=null==U?void 0:U.count)&&void 0!==e?e:0)/a.rowsPerPage),H=(null!==(t=null==U?void 0:U.count)&&void 0!==t?t:0)>0?X:1,Y=()=>{$()},J=()=>{ee()},$=()=>{let e=v-1;i.setPage(e)},ee=()=>{let e=v+1;i.setPage(e)},et=e=>{let t=e>X?X:e;i.setPage(t||1)};return(0,s.useEffect)(()=>{v&&v>H&&i.setPage(H)},[v,H]),(0,s.useEffect)(()=>{void 0!==o&&i.setEnforceExactCount(null!==u&&u<=T.Fi)},[o]),(0,l.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[Q&&(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Loading records count..."}),V&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,l.jsx)(I.z,{icon:(0,l.jsx)(R.Z,{}),type:"outline",className:"px-1.5",disabled:v<=1||Q,onClick:()=>{v>1&&(i.selectedRows.size>=1?k(!0):$())}}),(0,l.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,l.jsx)(L.I,{className:"w-12",size:"tiny",min:1,max:X,value:K,onChange:e=>Z(e.target.value),onKeyDown:e=>{let t=Number(K);"Enter"===e.code&&!Number.isNaN(t)&&t>=1&&t<=X&&et(t)}}),(0,l.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",H.toLocaleString()]}),(0,l.jsx)(I.z,{icon:(0,l.jsx)(_.Z,{}),type:"outline",className:"px-1.5",disabled:v>=X||Q,onClick:()=>{v<X&&(i.selectedRows.size>=1?j(!0):ee())}}),(0,l.jsx)(M.F,{options:A,onSelect:e=>{let t=Number(e);a.setRowsPerPage(isNaN(t)?100:t)},side:"top",align:"start",children:(0,l.jsx)(I.z,{asChild:!0,type:"outline",style:{padding:"3px 10px"},children:(0,l.jsx)("span",{children:"".concat(a.rowsPerPage," rows")})})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,l.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(B," ").concat(0===U.count||U.count>1?"records":"record")," ",U.is_estimate?"(estimated)":""]}),U.is_estimate&&(0,l.jsxs)(D.u,{children:[(0,l.jsx)(D.aJ,{asChild:!0,children:(0,l.jsx)(I.z,{size:"tiny",type:"text",className:"px-1.5",loading:q,icon:(0,l.jsx)(P.Z,{}),onClick:()=>{null===u||U.count>T.Fi?G(!0):i.setEnforceExactCount(!0)}})}),(0,l.jsxs)(D._v,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",T.Fi.toLocaleString()," rows. ",(0,l.jsx)("br",{}),(0,l.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),W&&(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,l.jsx)(F.Z,{visible:N,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>k(!1),onConfirm:()=>{Y()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,l.jsx)(F.Z,{visible:w,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>j(!1),onConfirm:()=>{J()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,l.jsx)(F.Z,{variant:"warning",visible:O,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>G(!1),onConfirm:()=>{i.setEnforceExactCount(!0),G(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:null===u?"If your table has a row count of greater than ".concat(T.Fi.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(T.Fi.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},G=e=>{let{isRefetching:t}=e,{project:n}=(0,m.d2)(),{id:o}=(0,d.UO)(),r=o?Number(o):void 0,{data:a}=(0,C.iB)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString,id:r}),[{view:i="data"},s]=(0,E.x)(),c=(0,S.D1)(a),u=(0,S.N3)(a);return(0,l.jsxs)(j.x,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===i&&(0,l.jsx)(O,{}),(0,l.jsxs)("div",{className:"ml-auto flex items-center gap-x-2",children:[a&&"data"===i&&(0,l.jsx)(k.Z,{tableId:a.id,isRefetching:t}),(c||u)&&(0,l.jsx)(N.Z,{width:75,options:["definition","data"],activeOption:i,borderOverride:"border",onClickOption:e=>{"data"===e?s({view:void 0}):s({view:e})}})]})]})},K=n(64492),Z=n(90186),U=n(99699),Q=n(111),V=n(11931),W=n(87941),q=n(16154),B=n(55456),X=n(87025),H=n(56213),Y=n(56634),J=n(51559),$=n(49686),ee=n(25027),et=n(65770),en=n(13319);function el(e,t){let{show:n}=(0,et.av)();return(0,l.jsx)(K.X2,{...t,onContextMenu:function(e){n(e,{id:en.ep,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let eo=e=>{var t;return null!==(t=null==e?void 0:e.idx)&&void 0!==t?t:-1},er=(0,s.memo)((0,s.forwardRef)((e,t)=>{var n;let{width:o,height:r,containerClass:a,gridClass:i,rowClass:d,rows:c,error:u,isLoading:f,isSuccess:x,isError:v,filters:y,onApplyFilters:w}=e,j=(0,g._2)(),N=(0,p.uM)(),C=function(e){let{project:t}=(0,m.d2)(),n=(0,p.uM)(),o=(0,X.NL)(),r=(0,h.MG)(),{mutate:a}=(0,ee.Gz)({async onMutate(e){let{projectRef:t,table:n,configuration:l,payload:r}=e,a=new Set(Object.keys(l.identifiers)),i=$.s.tableRows(t,{table:{id:n.id}});await o.cancelQueries(i);let s=o.getQueriesData(i);return o.setQueriesData(i,e=>{var t;return{rows:null!==(t=null==e?void 0:e.rows.map(e=>Object.entries(e).filter(e=>{let[t]=e;return a.has(t)}).every(e=>{let[t,n]=e;return n===l.identifiers[t]})?{...e,...r}:e))&&void 0!==t?t:[]}}),{previousRowsQueries:s}},onError(e,t,n){var l;let{previousRowsQueries:r}=n;r.forEach(e=>{let[t,n]=e;n&&o.setQueriesData(t,n),o.invalidateQueries(t)}),H.Am.error(null!==(l=null==e?void 0:e.message)&&void 0!==l?l:e)}});return(0,s.useCallback)((o,i)=>{var s;if(!t)return;let d=o[i.indexes[0]],c=e.find(e=>e.idx==d.idx),u=Object.keys(d).find(e=>d[e]!==c[e]);if(!c||!u)return;let f={[u]:d[u]},m=null===(s=n.originalTable.columns)||void 0===s?void 0:s.filter(e=>{var t;return(null!==(t=null==e?void 0:e.enums)&&void 0!==t?t:[]).length>0&&"array"===e.data_type.toLowerCase()}).map(e=>e.name),x={};if((0,S.N3)(n.originalTable)&&n.originalTable.primary_keys.forEach(e=>{let t=n.originalTable.columns.find(t=>t.name===e.name);x[e.name]=(null==t?void 0:t.format)==="bytea"?(0,Y.D4)(c[e.name]):c[e.name]}),0===Object.keys(x).length)return(0,H.Am)("Unable to update row as table has no primary keys",{description:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)(J.G,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})});a({projectRef:t.ref,connectionString:t.connectionString,table:n.originalTable,configuration:{identifiers:x},payload:f,enumArrayColumns:m,roleImpersonationState:r()})},[r,a,t,e,n.originalTable])}(c),E=(0,s.useRef)(null),k=N.table,{mutate:R}=(0,V.a)(),_=(0,W.l)(),{project:P}=(0,m.d2)(),{data:T}=(0,Q.XJ)({projectRef:null==P?void 0:P.ref,connectionString:null==P?void 0:P.connectionString,schema:null!==(n=null==k?void 0:k.schema)&&void 0!==n?n:void 0}),D=()=>{w([])};return(0,l.jsxs)("div",{className:(0,q.cn)("flex flex-col relative",a),style:{width:o||"100%",height:r||"50vh"},children:[0===(null!=c?c:[]).length&&(0,l.jsxs)("div",{style:{height:"calc(100% - 35px)"},className:"absolute top-9 z-[2] p-2 w-full",children:[f&&(0,l.jsx)(B.A,{}),v&&(0,l.jsx)(U.Z,{error:u,subject:"Failed to retrieve rows from table",children:y.length>0&&(0,l.jsx)("p",{children:"Verify that the filter values are correct, as the error may stem from an incorrectly applied filter"})}),x&&(0,l.jsx)(l.Fragment,{children:0===(null!=y?y:[]).length?(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full h-full",children:[(0,l.jsx)("p",{className:"text-sm text-light",children:"This table is empty"}),(0,l.jsx)("p",{className:"text-sm text-light mt-1",children:"Add rows to your table to get started."}),(0,l.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,l.jsx)(I.z,{type:"default",onClick:()=>{var e,t;j.onImportData(),R({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!==(e=null==P?void 0:P.ref)&&void 0!==e?e:"Unknown",organization:null!==(t=null==_?void 0:_.slug)&&void 0!==t?t:"Unknown"}})},children:"Import data from CSV"})})]}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full",children:[(0,l.jsx)("p",{className:"text-sm text-light",children:"The filters applied have returned no results from this table"}),(0,l.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,l.jsx)(I.z,{type:"default",onClick:()=>D(),children:"Remove all filters"})})]})})]}),(0,l.jsx)(K.ZP,{ref:t,className:"".concat(i," flex-grow"),rowClass:d,columns:N.gridColumns,rows:null!=c?c:[],renderers:{renderRow:el},rowKeyGetter:eo,selectedRows:N.selectedRows,onColumnResize:N.updateColumnSize,onRowsChange:C,onSelectedCellChange:function(e){E.current=e,N.setSelectedCellPosition({idx:e.column.idx,rowIdx:e.rowIdx})},onSelectedRowsChange:function(e){N.setSelectedRows(e)},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:l,targetTableName:o,targetColumnName:r}=null!==(n=null==k?void 0:null===(t=k.columns.find(t=>t.name==e))||void 0===t?void 0:t.foreignKey)&&void 0!==n?n:{},a=null==T?void 0:T.find(t=>t.source_schema===(null==k?void 0:k.schema)&&t.source_table===(null==k?void 0:k.name)&&t.source_columns.includes(e)&&t.target_schema===l&&t.target_table===o&&t.target_columns.includes(r));return void 0!==a?(0,Z.S)([a])[0]:void 0}(t.name);n&&j.onEditForeignKeyColumnValue({foreignKey:n,row:e,column:t})})(e.row,e.column),onCellKeyDown:b.FA})]})}));var ea=n(91237),ei=n(98754);let es=e=>{var t;let{customHeader:n,gridProps:o,children:r}=e,{id:a}=(0,d.UO)(),i=a?Number(a):void 0,{project:y}=(0,m.d2)(),j=(0,g._2)(),N=(0,p.uM)(),C=(0,s.useRef)(null),[S,E]=(0,s.useState)(!1),{filters:k,sorts:R,setParams:_}=(0,ei.T)(),P=(0,b.rg)(N.table.name,R),T=(0,b.Yb)(k),I=(0,s.useCallback)(e=>{N.setEnforceExactCount(!1),N.setPage(1);let t=(0,b.Wy)(e);_(e=>({...e,filter:t})),(null==y?void 0:y.ref)&&(0,b.kl)({projectRef:y.ref,tableName:N.table.name,schema:N.table.schema,filters:t})},[null==y?void 0:y.ref,N.table.name,N.table.schema]),D=(0,h.fN)(),{data:L,error:F,isSuccess:M,isError:z,isLoading:A,isRefetching:O}=(0,x.KK)({projectRef:null==y?void 0:y.ref,connectionString:null==y?void 0:y.connectionString,tableId:i,sorts:P,filters:T,page:N.page,limit:j.rowsPerPage,roleImpersonationState:D},{keepPreviousData:!0,retryDelay:(e,t)=>{var n;return(t&&(null===(n=t.message)||void 0===n?void 0:n.includes("does not exist"))&&_(e=>({...e,sort:void 0})),e>3)?1/0:5e3}});(0,s.useEffect)(()=>{S||E(!0)},[]);let K=null!==(t=null==L?void 0:L.rows)&&void 0!==t?t:v.Z6;return(0,l.jsx)(c.W,{backend:u.PD,context:window,"data-sentry-element":"DndProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,l.jsxs)("div",{className:"sb-grid h-full flex flex-col",children:[(0,l.jsx)(ea.ZP,{sorts:P,filters:T,customHeader:n,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),r||(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(er,{ref:C,...o,rows:K,error:F,isLoading:A,isSuccess:M,isError:z,filters:T,onApplyFilters:I}),(0,l.jsx)(G,{isRefetching:O}),(0,l.jsx)(w,{gridRef:C,rows:K})]}),S&&(0,f.createPortal)((0,l.jsx)(en.q4,{rows:K}),document.body)]})})};var ed=n(73343),ec=n(80905),eu=n(68026),ef=n(64888),em=n(87279),ex=n(11780),ev=e=>{let{id:t}=e;return(0,l.jsx)("div",{className:"flex items-center justify-center h-full","data-sentry-component":"NotFoundState","data-sentry-source-file":"NotFoundState.tsx",children:(0,l.jsx)("div",{className:"w-[400px]",children:(0,l.jsx)(em.Z,{icon:(0,l.jsx)(ex.Z,{strokeWidth:2}),title:"Unable to find your table with ID ".concat(t),"data-sentry-element":"InformationBox","data-sentry-source-file":"NotFoundState.tsx"})})})},eh=n(92721),eg=n(81098),ep=n(70706),eb=n(57672),ey=n.n(eb),ew=n(97339),ej=n(58971),eN=n(73571),eC=n(6545),eS=n(96404);let eE=e=>{let{id:t}=e;return"\n    ".concat(eC.k,"\n\n    with table_info as (\n      select \n        n.nspname::text as schema,\n        c.relname::text as name\n      from pg_class c\n      join pg_namespace n on n.oid = c.relnamespace\n      where c.oid = ").concat(t,"\n    )\n    select pg_temp.pg_get_tabledef (\n      t.schema,\n      t.name,\n      false,\n      'FKEYS_INTERNAL',\n      'INCLUDE_TRIGGERS'\n    ) as definition\n    from table_info t;\n  ").trim()};async function ek(e,t){let{projectRef:n,connectionString:l,id:o}=e;if(!o)throw Error("id is required");let r=eE({id:o}),{result:a}=await (0,eN.R)({projectRef:n,connectionString:l,sql:r,queryKey:["table-definition",o]},t);return a[0].definition.trim()}let eR=function(e){let{projectRef:t,connectionString:n,id:l}=e,{enabled:o=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ej.a)(eS.A.tableDefinition(t,l),e=>{let{signal:o}=e;return ek({projectRef:t,connectionString:n,id:l},o)},{enabled:o&&void 0!==t&&void 0!==l&&!isNaN(l),...r})};var e_=n(39521),eP=n(68759),eT=n(19732),eI=e=>{let{entity:t}=e,{ref:n}=(0,d.UO)(),o=(0,s.useRef)(null),r=(0,s.useRef)(null),{resolvedTheme:a}=(0,ep.F)(),{project:i}=(0,m.d2)(),c=(0,e_.s4)({id:null==t?void 0:t.id,projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString},{enabled:(0,S.D1)(t)}),u=eR({id:null==t?void 0:t.id,projectRef:null==i?void 0:i.ref,connectionString:null==i?void 0:i.connectionString},{enabled:(0,S.N3)(t)}),{data:f,isLoading:x}=(0,S.D1)(t)?c:u,v=(0,S.Du)(t)?"create view ".concat(t.schema,".").concat(t.name," as\n"):(0,S.z_)(t)?"create materialized view ".concat(t.schema,".").concat(t.name," as\n"):"",h=(0,s.useMemo)(()=>f?(0,eP._)(v+f):void 0,[f]),g=async(e,t)=>{o.current=e,r.current=t,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})}),await (0,eT.Vs)(500),null==e||e.focus()};return x?(0,l.jsxs)("div",{className:"h-full grid",children:[(0,l.jsx)("div",{className:"p-4",children:(0,l.jsx)(ew.A,{})}),(0,l.jsx)("div",{className:"mt-auto",children:(0,l.jsx)(G,{})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex-grow overflow-y-auto border-t border-muted relative",children:[(0,l.jsx)(I.z,{asChild:!0,type:"default",className:"absolute top-2 right-5 z-10","data-sentry-element":"Button","data-sentry-source-file":"TableDefinition.tsx",children:(0,l.jsx)(ey(),{href:"/project/".concat(n,"/sql/new?content=").concat(encodeURIComponent(null!=h?h:"")),"data-sentry-element":"Link","data-sentry-source-file":"TableDefinition.tsx",children:"Open in SQL Editor"})}),(0,l.jsx)(eg.default,{className:"monaco-editor",theme:(null==a?void 0:a.includes("dark"))?"vs-dark":"vs",onMount:g,defaultLanguage:"pgsql",value:h,path:"",options:{domReadOnly:!0,readOnly:!0,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0},"data-sentry-element":"Editor","data-sentry-source-file":"TableDefinition.tsx"})]}),(0,l.jsx)(G,{"data-sentry-element":"Footer","data-sentry-source-file":"TableDefinition.tsx"})]})},eD=e=>{var t;let{isLoadingSelectedTable:n=!1,selectedTable:r}=e,c=(0,i.useRouter)(),u=(0,ec.Vm)(),{ref:f,id:m}=(0,d.UO)();(0,b.bQ)({projectRef:f,table:r});let[{view:x="data"}]=(0,E.x)(),v=(0,ed.Xo)(o.KA.TENANT_SQL_ADMIN_WRITE,"tables"),h=(0,ed.Xo)(o.KA.TENANT_SQL_ADMIN_WRITE,"columns"),g=(0,s.useCallback)(e=>{c.push("/project/".concat(f,"/editor/").concat(e.id))},[f,c]);if(n||!f)return(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsx)("div",{className:"h-10 bg-dash-sidebar dark:bg-surface-100"}),(0,l.jsx)("div",{className:"h-9 border-y"}),(0,l.jsx)("div",{className:"p-2 col-span-full",children:(0,l.jsx)(B.A,{})})]});if(a()(r))return(0,l.jsx)(ev,{id:Number(m)});let y=(0,S.Du)(r)||(0,S.z_)(r),w=(0,S.N3)(r),j=eu.s.includes(null!==(t=null==r?void 0:r.schema)&&void 0!==t?t:""),N=!(!v&&!h)&&w&&!j,C="".concat(r.schema,"_").concat(r.name);return(0,l.jsx)("div",{className:"h-full",onClick:()=>(0,ef.n0)(null==u?void 0:u.ref),"data-sentry-component":"TableGridEditor","data-sentry-source-file":"TableGridEditor.tsx",children:(0,l.jsxs)(p.t,{projectRef:f,table:r,editable:N,"data-sentry-element":"TableEditorTableStateContextProvider","data-sentry-source-file":"TableGridEditor.tsx",children:[(0,l.jsx)(es,{gridProps:{height:"100%"},customHeader:(y||w)&&"definition"===x?(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)("p",{children:["SQL Definition of ",(0,l.jsx)("code",{className:"text-sm",children:r.name})," "]}),(0,l.jsx)("p",{className:"text-foreground-light text-sm",children:"(Read only)"})]}):null,"data-sentry-element":"SupabaseGrid","data-sentry-source-file":"TableGridEditor.tsx",children:(y||w)&&"definition"===x&&(0,l.jsx)(eI,{entity:r})},C),(0,l.jsx)(eh.Z,{editable:N,selectedTable:(0,S.N3)(r)?r:void 0,onTableCreated:g,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"TableGridEditor.tsx"})]},"table-editor-table-".concat(r.id))})};n(23191)},43083:function(e,t,n){n.d(t,{a:function(){return r}});var l=n(44194);function o(e,t){return e.indexOf(t)>=0}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[r,a]=l.useState(),i=l=>{if(!e||o(t,l.target.nodeName)||o(n,l.target.className))return;let r=l.metaKey&&l.shiftKey?"Command+Shift+".concat(l.key):l.metaKey?"Command+".concat(l.key):l.shiftKey&&"Enter"===l.key?"Shift+".concat(l.key):l.ctrlKey&&l.key?"Control+".concat(l.key):l.key;e[r]&&(r.includes("+")?(l.preventDefault(),e[r](l),a(null)):(a(l.key),l.preventDefault()))},s=t=>{e&&e[t.key]&&r===t.key&&(t.preventDefault(),e[t.key](t),a(null))};l.useEffect(()=>(window.addEventListener("keydown",i),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",i),window.removeEventListener("keyup",s)}))}},21930:function(e,t,n){n.d(t,{x:function(){return r}});var l=n(31549),o=n(16154);let r=e=>{let{children:t,className:n}=e;return(0,l.jsx)("div",{className:(0,o.cn)("flex min-h-9 h-9 overflow-hidden overflow-x-auto items-center px-2 w-full border-t",n),"data-sentry-component":"GridFooter","data-sentry-source-file":"GridFooter.tsx",children:t})}}}]);